import numpy as np

Cosmology = {
    'h' : 0.6766,
    'H0' : 2.192695336552484e-18, # H0 for h
    'OmCh2' : 0.11933,
    'OmBh2' : 0.02242,
    'OmMh2' : 0.14175010989853876,
    'OmC' : 0.260667,
    'OmB' : 0.04897468161,
    'OmM' : 0.30964168161,
    'OmR' : 9.1E-5,
    'zeq' : 3401.6558418681316,
    't0' : 4.3523939036782445e+17, # Age of the Universe today
    'YHe' : 0.245, # Helium mass density fraction
    'RhoCr' : 8.6018282524e-27, # Critical density, in kg/m^3
    'nH0' : 0.1901567053460595, # Number density of H neclei today, in m^-3
    'fHe' : 0.08112582781456953, # nHe/nH, YHe/(4 (1 - YHe)), fraction of number densities of He and H neclei assuming YHe = 0.245. electron mass, mp-mn ignored
}

Constants = {
    'kB' : 1.38064852E-23, # Boltzmann constant
    'G' : 6.6740831313131E-11, # Gravitational Constant, dimension : L^3/t^2/M
    'h_plk' : 6.626070040818181818E-34, # Planck Constant
    'hbar' : 1.0545718002693302e-34, # Reduced Planck Constant
    'Q' : 1.602176634E-19, # Electrical Charge Quanta
    'Elec_Mass_eV' : 510998.9461, # Electron mass in eV
    'c' : 299792458, # Speed of light in m/s
    'Mpc' : 3.086E22, # Mpc in m
    'pc' : 3.086E16, # pc in m
    'msun' : 1.98847E30, # Solar mass in kg
    'mp' : 1.67262158e-27, # proton mass in kg
    'me' : 9.109383632044565e-31, # electron mass in kg
    'SigmaT' : 0.665245854E-28, # Thomson cross-section, in m^2,
    'yr' : 31557600.0, # number of seconds per year
}

# Oesch 18 UVLF Data (1710.11131), do NOT use upper bound at -22.25 mag
Oesch_UVLF_z10_data = {
    'MUV': np.array([-21.25, -20.25, -19.25, -18.25, -17.25]),
    'Mean': 1E-4 * np.array([0.01, 0.1, 0.34, 1.9, 6.3]),
    'Error_up': 1E-4 * np.array([0.022, 0.1, 0.45, 2.5, 14.9]),
    'Error_low': 1E-4 * np.array([0.008, 0.05, 0.22, 1.2, 5.2])
    }

# Bouwens 15 UVLF Data (1403.4295)
Bouwens_UVLF_data = {
    'z4':{
        'MUV': np.array([-22.69, -22.19, -21.69, -21.19, -20.69, -20.19, -19.69, -19.19, -18.69, -18.19, -17.69, -16.94, -15.94]),
        'Mean': np.array([0.000003, 0.000015, 0.000134, 0.000393, 0.000678, 0.001696, 0.002475, 0.002984, 0.005352, 0.006865, 0.010473, 0.024580, 0.025080]),
        'Error': np.array([0.000004, 0.000009, 0.000023, 0.000040, 0.000063, 0.000113, 0.000185, 0.000255, 0.000446, 0.001043, 0.002229, 0.003500, 0.007860])
    },
    'z5':{
        'MUV': np.array([-23.11, -22.61, -22.11, -21.61, -21.11, -20.61, -20.11, -19.61, -19.11, -18.36, -17.36, -16.36]),
        'Mean': np.array([0.000002, 0.000006, 0.000034, 0.000101, 0.000265, 0.000676, 0.001029, 0.001329, 0.002085, 0.004460, 0.008600, 0.024400]),
        'Error': np.array([0.000002, 0.000003, 0.000008, 0.000014, 0.000025, 0.000046, 0.000067, 0.000094, 0.000171, 0.000540, 0.001760, 0.007160])
    },
    'z6':{
        'MUV': np.array([-22.52, -22.02, -21.52, -21.02, -20.52, -20.02, -19.52, -18.77, -17.77, -16.77]),
        'Mean': np.array([0.000002, 0.000015, 0.000053, 0.000176, 0.000320, 0.000698, 0.001246, 0.001900, 0.006680, 0.013640]),
        'Error': np.array([0.000002, 0.000006, 0.000012, 0.000025, 0.000041, 0.000083, 0.000137, 0.000320, 0.001380, 0.004200])
    },
    'z7':{
        'MUV': np.array([-22.16, -21.66, -21.16, -20.66, -20.16, -19.66, -19.16, -18.66, -17.91, -16.91]),
        'Mean': np.array([0.000001, 0.000033, 0.000048, 0.000193, 0.000309, 0.000654, 0.000907, 0.001717, 0.005840, 0.008500]),
        'Error': np.array([0.000002, 0.000009, 0.000015, 0.000034, 0.000061, 0.000100, 0.000177, 0.000478, 0.001460, 0.002940])
    },
    'z8':{
        'MUV': np.array([-21.87, -21.37, -20.87, -20.37, -19.87, -19.37, -18.62, -17.62]),
        'Mean': np.array([0.000005, 0.000013, 0.000058, 0.000060, 0.000331, 0.000533, 0.001060, 0.002740]),
        'Error': np.array([0.000003, 0.000005, 0.000015, 0.000026, 0.000104, 0.000226, 0.000340, 0.001040])
    },
    'z10':{
        'MUV': np.array([-21.23, -20.23, -18.23]),
        'Mean': np.array([0.000001, 0.000010, 0.000266]),
        'Error': np.array([0.000001, 0.000005, 0.000171])
    }
}

LCDM_Recombination_Template = {
    'log10_zp': np.array([
        0.0000, 0.0171, 0.0342, 0.0513, 0.0683, 0.0854, 0.1025, 0.1196, 0.1367, 0.1538, 0.1709, 0.1879, 0.2050, 0.2221, 0.2392, 0.2563, 0.2734, 0.2905, 0.3075, 0.3246, 
        0.3417, 0.3588, 0.3759, 0.3930, 0.4101, 0.4271, 0.4442, 0.4613, 0.4784, 0.4955, 0.5126, 0.5296, 0.5467, 0.5638, 0.5809, 0.5980, 0.6151, 0.6322, 0.6492, 0.6663, 
        0.6834, 0.7005, 0.7176, 0.7347, 0.7518, 0.7688, 0.7859, 0.8030, 0.8201, 0.8372, 0.8543, 0.8714, 0.8884, 0.9055, 0.9226, 0.9397, 0.9568, 0.9739, 0.9910, 1.0080, 
        1.0251, 1.0422, 1.0593, 1.0764, 1.0935, 1.1106, 1.1276, 1.1447, 1.1618, 1.1789, 1.1960, 1.2131, 1.2302, 1.2472, 1.2643, 1.2814, 1.2985, 1.3156, 1.3327, 1.3497, 
        1.3668, 1.3839, 1.4010, 1.4181, 1.4352, 1.4523, 1.4693, 1.4864, 1.5035, 1.5206, 1.5377, 1.5548, 1.5719, 1.5889, 1.6060, 1.6231, 1.6402, 1.6573, 1.6744, 1.6915, 
        1.7085, 1.7256, 1.7427, 1.7598, 1.7769, 1.7940, 1.8111, 1.8281, 1.8452, 1.8623, 1.8794, 1.8965, 1.9136, 1.9307, 1.9477, 1.9648, 1.9819, 1.9990, 2.0161, 2.0332, 
        2.0503, 2.0673, 2.0844, 2.1015, 2.1186, 2.1357, 2.1528, 2.1698, 2.1869, 2.2040, 2.2211, 2.2382, 2.2553, 2.2724, 2.2894, 2.3065, 2.3236, 2.3407, 2.3578, 2.3749, 
        2.3920, 2.4090, 2.4261, 2.4432, 2.4603, 2.4774, 2.4945, 2.5116, 2.5286, 2.5457, 2.5628, 2.5799, 2.5970, 2.6141, 2.6312, 2.6482, 2.6653, 2.6824, 2.6995, 2.7166, 
        2.7337, 2.7508, 2.7678, 2.7849, 2.8020, 2.8191, 2.8362, 2.8533, 2.8704, 2.8874, 2.9045, 2.9216, 2.9387, 2.9558, 2.9729, 2.9899, 3.0070, 3.0241, 3.0412, 3.0583, 
        3.0754, 3.0925, 3.1095, 3.1266, 3.1437, 3.1608, 3.1779, 3.1950, 3.2121, 3.2291, 3.2462, 3.2633, 3.2804, 3.2975, 3.3146, 3.3317, 3.3487, 3.3658, 3.3829, 3.4000]),
    'log10_Tk': np.array([
        -1.6639, -1.6145, -1.5686, -1.5254, -1.4846, -1.4459, -1.4090, -1.3737, -1.3398, -1.3071, -1.2756, -1.2450, -1.2153, -1.1865, -1.1584, -1.1310, -1.1042, -1.0780, 
        -1.0459, -1.0053, -0.9668, -0.9300, -0.8948, -0.8610, -0.8284, -0.7969, -0.7664, -0.7368, -0.7072, -0.6685, -0.6316, -0.5964, -0.5625, -0.5298, -0.4983, -0.4677, 
        -0.4319, -0.3957, -0.3611, -0.3277, -0.2956, -0.2638, -0.2274, -0.1924, -0.1589, -0.1265, -0.0927, -0.0573, -0.0234, 0.0093, 0.0434, 0.0782, 0.1117, 0.1446, 0.1797, 
        0.2135, 0.2465, 0.2814, 0.3149, 0.3487, 0.3829, 0.4159, 0.4505, 0.4838, 0.5180, 0.5514, 0.5856, 0.6189, 0.6530, 0.6864, 0.7203, 0.7539, 0.7872, 0.8211, 0.8546, 0.8880, 
        0.9215, 0.9550, 0.9884, 1.0217, 1.0550, 1.0882, 1.1214, 1.1546, 1.1877, 1.2207, 1.2537, 1.2865, 1.3193, 1.3520, 1.3847, 1.4172, 1.4497, 1.4821, 1.5144, 1.5465, 1.5786, 
        1.6105, 1.6424, 1.6740, 1.7056, 1.7370, 1.7683, 1.7994, 1.8304, 1.8612, 1.8918, 1.9223, 1.9525, 1.9826, 2.0124, 2.0421, 2.0715, 2.1007, 2.1297, 2.1584, 2.1868, 2.2151, 
        2.2430, 2.2707, 2.2981, 2.3253, 2.3521, 2.3786, 2.4049, 2.4308, 2.4565, 2.4818, 2.5068, 2.5315, 2.5559, 2.5800, 2.6037, 2.6271, 2.6503, 2.6731, 2.6956, 2.7178, 2.7397, 
        2.7613, 2.7827, 2.8037, 2.8245, 2.8451, 2.8654, 2.8854, 2.9053, 2.9249, 2.9443, 2.9635, 2.9826, 3.0015, 3.0202, 3.0387, 3.0572, 3.0755, 3.0937, 3.1117, 3.1297, 3.1476, 
        3.1654, 3.1831, 3.2007, 3.2183, 3.2358, 3.2533, 3.2707, 3.2881, 3.3055, 3.3228, 3.3400, 3.3572, 3.3744, 3.3915, 3.4087, 3.4258, 3.4429, 3.4600, 3.4770, 3.4941, 3.5112, 
        3.5283, 3.5454, 3.5625, 3.5796, 3.5966, 3.6137, 3.6308, 3.6479, 3.6650, 3.6821, 3.6992, 3.7162, 3.7333, 3.7504, 3.7675, 3.7846, 3.8017, 3.8188, 3.8358]),
    'log10_xe' : np.array([
        -3.7579, -3.7576, -3.7572, -3.7568, -3.7564, -3.7559, -3.7555, -3.7550, -3.7546, -3.7541, -3.7535, -3.7530, -3.7524, -3.7519, -3.7513, -3.7506, -3.7500, -3.7493, 
        -3.7487, -3.7480, -3.7474, -3.7467, -3.7460, -3.7452, -3.7444, -3.7436, -3.7428, -3.7419, -3.7411, -3.7403, -3.7395, -3.7386, -3.7378, -3.7368, -3.7359, -3.7349, 
        -3.7340, -3.7331, -3.7322, -3.7312, -3.7302, -3.7291, -3.7281, -3.7271, -3.7261, -3.7250, -3.7239, -3.7228, -3.7217, -3.7206, -3.7195, -3.7183, -3.7172, -3.7160, 
        -3.7148, -3.7136, -3.7123, -3.7111, -3.7099, -3.7086, -3.7073, -3.7060, -3.7046, -3.7033, -3.7019, -3.7005, -3.6991, -3.6977, -3.6963, -3.6948, -3.6933, -3.6918, 
        -3.6903, -3.6885, -3.6867, -3.6849, -3.6830, -3.6812, -3.6793, -3.6773, -3.6754, -3.6734, -3.6713, -3.6693, -3.6672, -3.6651, -3.6629, -3.6607, -3.6585, -3.6562, 
        -3.6539, -3.6516, -3.6492, -3.6467, -3.6443, -3.6418, -3.6392, -3.6366, -3.6339, -3.6312, -3.6285, -3.6257, -3.6228, -3.6199, -3.6169, -3.6139, -3.6108, -3.6077, 
        -3.6044, -3.6011, -3.5978, -3.5943, -3.5908, -3.5872, -3.5835, -3.5797, -3.5758, -3.5719, -3.5678, -3.5636, -3.5593, -3.5549, -3.5504, -3.5457, -3.5409, -3.5360, 
        -3.5309, -3.5256, -3.5202, -3.5146, -3.5088, -3.5028, -3.4965, -3.4901, -3.4834, -3.4765, -3.4692, -3.4617, -3.4539, -3.4457, -3.4372, -3.4283, -3.4190, -3.4092, 
        -3.3990, -3.3882, -3.3769, -3.3649, -3.3523, -3.3390, -3.3249, -3.3099, -3.2939, -3.2769, -3.2587, -3.2392, -3.2181, -3.1954, -3.1708, -3.1439, -3.1145, -3.0820, 
        -3.0459, -3.0054, -2.9595, -2.9069, -2.8455, -2.7726, -2.6846, -2.5767, -2.4437, -2.2821, -2.0929, -1.8832, -1.6632, -1.4426, -1.2288, -1.0265, -0.8392, -0.6690, 
        -0.5173, -0.3844, -0.2705, -0.1758, -0.1011, -0.0480, -0.0174, -0.0049, -0.0013, -0.0003, 0.0012, 0.0053, 0.0107, 0.0157, 0.0197, 0.0230, 0.0256, 0.0278, 0.0295, 0.0310])
}

def Get_EDGES_Profile():
    File = '/Users/cangtao/cloud/GitHub/Radio_Excess_EDGES/data/Data_EDGES.txt'
    data = np.loadtxt(File)
    v = data[:,0]
    t21 = data[:,5]*1000
    z = 1420/v - 1
    return z, t21

# EOS21 templates, use HyRec at high Z and 21cmFAST at low z
EOS21_EoR_Template = {
    'py21cmfast_zmax' : 35.6,
    'log10_zp': np.array([
        0.0000, 0.0171, 0.0342, 0.0513, 0.0683, 0.0854, 0.1025, 0.1196, 0.1367, 0.1538, 0.1709, 0.1879, 0.2050, 0.2221, 0.2392, 0.2563, 0.2734, 0.2905, 0.3075, 0.3246, 
        0.3417, 0.3588, 0.3759, 0.3930, 0.4101, 0.4271, 0.4442, 0.4613, 0.4784, 0.4955, 0.5126, 0.5296, 0.5467, 0.5638, 0.5809, 0.5980, 0.6151, 0.6322, 0.6492, 0.6663, 
        0.6834, 0.7005, 0.7176, 0.7347, 0.7518, 0.7688, 0.7859, 0.8030, 0.8201, 0.8372, 0.8543, 0.8714, 0.8884, 0.9055, 0.9226, 0.9397, 0.9568, 0.9739, 0.9910, 1.0080, 
        1.0251, 1.0422, 1.0593, 1.0764, 1.0935, 1.1106, 1.1276, 1.1447, 1.1618, 1.1789, 1.1960, 1.2131, 1.2302, 1.2472, 1.2643, 1.2814, 1.2985, 1.3156, 1.3327, 1.3497, 
        1.3668, 1.3839, 1.4010, 1.4181, 1.4352, 1.4523, 1.4693, 1.4864, 1.5035, 1.5206, 1.5377, 1.5548, 1.5719, 1.5889, 1.6060, 1.6231, 1.6402, 1.6573, 1.6744, 1.6915, 
        1.7085, 1.7256, 1.7427, 1.7598, 1.7769, 1.7940, 1.8111, 1.8281, 1.8452, 1.8623, 1.8794, 1.8965, 1.9136, 1.9307, 1.9477, 1.9648, 1.9819, 1.9990, 2.0161, 2.0332, 
        2.0503, 2.0673, 2.0844, 2.1015, 2.1186, 2.1357, 2.1528, 2.1698, 2.1869, 2.2040, 2.2211, 2.2382, 2.2553, 2.2724, 2.2894, 2.3065, 2.3236, 2.3407, 2.3578, 2.3749, 
        2.3920, 2.4090, 2.4261, 2.4432, 2.4603, 2.4774, 2.4945, 2.5116, 2.5286, 2.5457, 2.5628, 2.5799, 2.5970, 2.6141, 2.6312, 2.6482, 2.6653, 2.6824, 2.6995, 2.7166, 
        2.7337, 2.7508, 2.7678, 2.7849, 2.8020, 2.8191, 2.8362, 2.8533, 2.8704, 2.8874, 2.9045, 2.9216, 2.9387, 2.9558, 2.9729, 2.9899, 3.0070, 3.0241, 3.0412, 3.0583, 
        3.0754, 3.0925, 3.1095, 3.1266, 3.1437, 3.1608, 3.1779, 3.1950, 3.2121, 3.2291, 3.2462, 3.2633, 3.2804, 3.2975, 3.3146, 3.3317, 3.3487, 3.3658, 3.3829, 3.4000]),

    'log10_Tk' : np.array([
        4.4122, 4.4181, 4.4242, 4.4305, 4.4369, 4.4434, 4.4501, 4.4570, 4.4640, 4.4712, 4.4786, 4.4861, 4.4938, 4.5017, 4.5097, 4.5179, 4.5263, 4.5348, 4.5380, 4.5322, 
        4.5260, 4.5194, 4.5125, 4.5053, 4.4975, 4.4894, 4.4807, 4.4715, 4.4610, 4.4398, 4.4167, 4.3912, 4.3631, 4.3317, 4.2965, 4.2565, 4.2197, 4.1810, 4.1367, 4.0852, 
        4.0243, 3.9536, 3.9039, 3.8455, 3.7750, 3.6871, 3.6012, 3.5317, 3.4454, 3.3326, 3.2244, 3.1302, 3.0041, 2.8375, 2.7409, 2.6105, 2.4370, 2.3360, 2.1979, 2.0556, 
        1.9431, 1.7887, 1.6894, 1.5543, 1.4505, 1.3321, 1.2387, 1.1375, 1.0680, 0.9961, 0.9513, 0.9161, 0.8928, 0.8884, 0.8916, 0.9029, 0.9221, 0.9463, 0.9737, 1.0035, 
        1.0349, 1.0675, 1.1007, 1.1344, 1.1684, 1.2024, 1.2365, 1.2705, 1.3045, 1.3384, 1.3723, 1.4059, 1.4497, 1.4821, 1.5144, 1.5465, 1.5786, 1.6105, 1.6424, 1.6740, 
        1.7056, 1.7370, 1.7683, 1.7994, 1.8304, 1.8612, 1.8918, 1.9223, 1.9525, 1.9826, 2.0124, 2.0421, 2.0715, 2.1007, 2.1297, 2.1584, 2.1868, 2.2151, 2.2430, 2.2707, 
        2.2981, 2.3253, 2.3521, 2.3786, 2.4049, 2.4308, 2.4565, 2.4818, 2.5068, 2.5315, 2.5559, 2.5800, 2.6037, 2.6271, 2.6503, 2.6731, 2.6956, 2.7178, 2.7397, 2.7613, 
        2.7827, 2.8037, 2.8245, 2.8451, 2.8654, 2.8854, 2.9053, 2.9249, 2.9443, 2.9635, 2.9826, 3.0015, 3.0202, 3.0387, 3.0572, 3.0755, 3.0937, 3.1117, 3.1297, 3.1476, 
        3.1654, 3.1831, 3.2007, 3.2183, 3.2358, 3.2533, 3.2707, 3.2881, 3.3055, 3.3228, 3.3400, 3.3572, 3.3744, 3.3915, 3.4087, 3.4258, 3.4429, 3.4600, 3.4770, 3.4941, 
        3.5112, 3.5283, 3.5454, 3.5625, 3.5796, 3.5966, 3.6137, 3.6308, 3.6479, 3.6650, 3.6821, 3.6992, 3.7162, 3.7333, 3.7504, 3.7675, 3.7846, 3.8017, 3.8188, 3.8358]),
    'log10_xe' : np.array([
        0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 
        0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 
        0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0653, 0.0567, 0.0365, 0.0145, -0.0096, -0.0420, -0.0840, -0.1325, -0.1863, -0.2291, -0.2785, -0.3335, -0.3777, -0.4290,
        -0.4802, -0.5285, -0.5843, -0.6328, -0.6898, -0.7432, -0.8034, -0.8620, -0.9284, -0.9924, -1.0658, -1.1387, -1.2185, -1.3072, -1.3947, -1.4921, -1.5994, -1.7109, 
        -1.8289, -1.9572, -2.0955, -2.2441, -2.4023, -2.5687, -2.7413, -2.9161, -3.0879, -3.2487, -3.3858, -3.4881, -3.5528, -3.6196, -3.6421, -3.6492, -3.6467, -3.6443, 
        -3.6418, -3.6392, -3.6366, -3.6339, -3.6312, -3.6285, -3.6257, -3.6228, -3.6199, -3.6169, -3.6139, -3.6108, -3.6077, -3.6044, -3.6011, -3.5978, -3.5943, -3.5908, 
        -3.5872, -3.5835, -3.5797, -3.5758, -3.5719, -3.5678, -3.5636, -3.5593, -3.5549, -3.5504, -3.5457, -3.5409, -3.5360, -3.5309, -3.5256, -3.5202, -3.5146, -3.5088, 
        -3.5028, -3.4965, -3.4901, -3.4834, -3.4765, -3.4692, -3.4617, -3.4539, -3.4457, -3.4372, -3.4283, -3.4190, -3.4092, -3.3990, -3.3882, -3.3769, -3.3649, -3.3523, 
        -3.3390, -3.3249, -3.3099, -3.2939, -3.2769, -3.2587, -3.2392, -3.2181, -3.1954, -3.1708, -3.1439, -3.1145, -3.0820, -3.0459, -3.0054, -2.9595, -2.9069, -2.8455, 
        -2.7726, -2.6846, -2.5767, -2.4437, -2.2821, -2.0929, -1.8832, -1.6632, -1.4426, -1.2288, -1.0265, -0.8392, -0.6690, -0.5173, -0.3844, -0.2705, -0.1758, -0.1011, 
        -0.0480, -0.0174, -0.0049, -0.0013, -0.0003, 0.0012, 0.0053, 0.0107, 0.0157, 0.0197, 0.0230, 0.0256, 0.0278, 0.0295, 0.0310])
}
